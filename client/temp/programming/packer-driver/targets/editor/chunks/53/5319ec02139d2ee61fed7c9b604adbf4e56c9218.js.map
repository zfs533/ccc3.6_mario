{"version":3,"sources":["file:///E:/CocosCreator/git/mario/client/assets/script/game/roles/enemy/enemyTortoise.ts"],"names":["_decorator","UITransform","clientEvent","Constant","EnumEnemyStatus","MarioStatus","enemy","ccclass","property","enemyTortoise","_isDown","start","attactedNode","active","animComp","status","walk","refreshSpeedByStatus","onBeginContact","selfCollider","otherCollider","contact","isDeath","name1","node","name","name2","includes","y1","position","y","h2","getComponent","height","y2","isColider","dispatchEvent","EVENT_TYPE","ChangeStatus","idle","scheduleOnce","loadInsideTexture","run","stand","MarioDeath","Jump"],"mappings":"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","sourcesContent":["import { _decorator, Component, Node, Collider2D, UITransform, IPhysics2DContact, Sprite } from 'cc';\r\nimport { clientEvent } from '../../../framework/clientEvent';\r\nimport { Constant } from '../../../framework/constant';\r\nimport { EnumEnemyStatus, MarioStatus } from '../../../framework/enum';\r\nimport { resourceUtil } from '../../../framework/resourceUtil';\r\nimport { enemy } from './enemy';\r\nconst { ccclass, property } = _decorator;\r\n/**\r\n * 普通乌龟\r\n */\r\n@ccclass('enemyTortoise')\r\nexport class enemyTortoise extends enemy {\r\n    private _isDown:boolean = false;\r\n    start(){\r\n        super.start();\r\n        if(this.attactedNode) this.attactedNode.active = false;\r\n        if(this.animComp) this.animComp.active = true\r\n        this.status = EnumEnemyStatus.walk;\r\n        this.refreshSpeedByStatus();\r\n    }\r\n\r\n    public onBeginContact(selfCollider: Collider2D, otherCollider: Collider2D, contact: IPhysics2DContact | null) {\r\n        super.onBeginContact(selfCollider, otherCollider, contact);\r\n        if (this.isDeath) return;\r\n        // 只在两个碰撞体开始接触时被调用一次\r\n        let name1 = selfCollider.node.name;\r\n        let name2 = otherCollider.node.name;\r\n        if (name2.includes(\"mario\")) {\r\n            let y1 = selfCollider.node.position.y;\r\n            let h2 = selfCollider.node.getComponent(UITransform).height;\r\n            y1 += h2;\r\n            let y2 = otherCollider.node.position.y\r\n            if (y2 >= y1 && !this.isColider) {//这里要动态加载被踩的图片\r\n                this.isColider = true;\r\n                clientEvent.dispatchEvent(Constant.EVENT_TYPE.ChangeStatus,MarioStatus.idle);\r\n                this.scheduleOnce(()=>{this.isColider = false},0.1);\r\n                this.loadInsideTexture();\r\n                if(this.status == EnumEnemyStatus.walk || this.status == EnumEnemyStatus.run){\r\n                    this.status = EnumEnemyStatus.stand;\r\n                }\r\n                else if(this.status == EnumEnemyStatus.stand){\r\n                    this.status = EnumEnemyStatus.run;\r\n                }\r\n                this.refreshSpeedByStatus();\r\n            }\r\n            else if(y2 < y1){\r\n                clientEvent.dispatchEvent(Constant.EVENT_TYPE.MarioDeath);\r\n            }\r\n        }\r\n    }\r\n\r\n    private loadInsideTexture(){\r\n        if(this._isDown)return;\r\n        this._isDown = true;\r\n        if(this.attactedNode){\r\n            this.attactedNode.active = true;\r\n            this.animComp.active = false;\r\n            clientEvent.dispatchEvent(Constant.EVENT_TYPE.Jump);\r\n        }\r\n    }\r\n}\r\n\r\n\r\n"]}