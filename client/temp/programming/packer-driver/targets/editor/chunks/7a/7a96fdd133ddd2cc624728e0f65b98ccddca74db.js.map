{"version":3,"sources":["file:///E:/CocosCreator/git/mario/client/assets/script/framework/resourceUtil.ts"],"names":["_decorator","Prefab","SpriteComponent","SpriteFrame","resources","error","Texture2D","instantiate","isValid","find","Color","ccclass","resourceUtil","loadRes","url","type","cb","load","err","res","message","loadPiecesPriefabRes","modulePath","Promise","resolve","reject","prefab","console","loadModelRes","loadMapModelRes","loadSpriteFrameRes","path","img","texture","image","sf","setAvatarIcon","name","sprite","then","spriteFrame","log","getMap","level","levelStr","txtAsset","content","_file","window","decompressFromEncodedURIComponent","objJson","JSON","parse","text","json","getUIPrefabRes","prefabPath","createUI","parent","node","setPosition","addChild","getUICar","getCar","setCarIcon","isBlack","setSpriteFrame","getJsonData","fileName","getData","nativeUrl","getCustomer","setCustomerIcon","getEffect","setGray","flag","sprites","getComponentsInChildren","i","length","color","getHat","getShoes"],"mappings":"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","sourcesContent":["import { _decorator, Prefab, Node, SpriteComponent, SpriteFrame, Rect, ImageAsset, resources, error, Texture2D, instantiate, isValid, find, loader, Color } from \"cc\";\r\nconst { ccclass } = _decorator;\r\n\r\n@ccclass(\"resourceUtil\")\r\nexport class resourceUtil {\r\n    /**\r\n     * 加载资源\r\n     * @param url   资源路径\r\n     * @param type  资源类型\r\n     * @param cb    回调\r\n     * @method loadRes\r\n     */\r\n    public static loadRes(url: string, type: any, cb: Function) {\r\n        resources.load(url, (err: any, res: any) => {\r\n            if (err) {\r\n                error(err.message || err);\r\n                cb(err, res);\r\n                return;\r\n            }\r\n\r\n            cb(null, res);\r\n        })\r\n    }\r\n\r\n    public static loadPiecesPriefabRes(modulePath: string) {\r\n        return new Promise((resolve, reject) => {\r\n            this.loadRes(`prefab/pieces/${modulePath}`, Prefab, (err: any, prefab: Prefab) => {\r\n                if (err) {\r\n                    console.error('effect load failed', modulePath);\r\n                    reject && reject();\r\n                    return;\r\n                }\r\n\r\n                resolve && resolve(prefab);\r\n            })\r\n        })\r\n    }\r\n\r\n    public static loadModelRes(modulePath: string) {\r\n        return new Promise((resolve, reject) => {\r\n            this.loadRes(`prefab/model/${modulePath}`, Prefab, (err: any, prefab: Prefab) => {\r\n                if (err) {\r\n                    console.error(\"model load failed\", modulePath);\r\n                    reject && reject();\r\n                    return;\r\n                }\r\n\r\n                resolve && resolve(prefab);\r\n            })\r\n        })\r\n    }\r\n\r\n    public static loadMapModelRes(modulePath: string) {\r\n        return new Promise((resolve, reject) => {\r\n            this.loadRes(`map/${modulePath}`, Prefab, (err: any, prefab: Prefab) => {\r\n                if (err) {\r\n                    console.error(\"map model load failed\", modulePath);\r\n                    reject && reject();\r\n                    return;\r\n                }\r\n\r\n                resolve && resolve(prefab);\r\n            })\r\n        })\r\n    }\r\n    public static loadSpriteFrameRes(path: string) {\r\n        return new Promise((resolve, reject) => {\r\n            this.loadRes(path, SpriteFrame, (err: any, img: ImageAsset) => {\r\n                if (err) {\r\n                    console.error('spriteFrame load failed!', path, err);\r\n                    reject && reject();\r\n                    return;\r\n                }\r\n\r\n                let texture = new Texture2D();\r\n                texture.image = img;\r\n\r\n                let sf = new SpriteFrame();\r\n                sf.texture = texture;\r\n\r\n                resolve && resolve(sf);\r\n            })\r\n        })\r\n    }\r\n\r\n    public static setAvatarIcon(name: string, sprite: SpriteComponent, cb?: Function) {\r\n        this.loadSpriteFrameRes(`textures/avatar/${name}`).then((sf) => {\r\n            if (sprite && isValid(sprite)) {\r\n                sprite.spriteFrame = sf as SpriteFrame;\r\n                cb && cb();\r\n            } else {\r\n                console.log(\"sprite is null\");\r\n            }\r\n        })\r\n    }\r\n\r\n    public static getMap(level: number, cb: Function) {\r\n        let levelStr = 'map';\r\n        //前面补0\r\n        if (level >= 100) {\r\n            levelStr += level;\r\n        } else if (level >= 10) {\r\n            levelStr += '0' + level;\r\n        } else {\r\n            levelStr += '00' + level;\r\n        }\r\n\r\n        this.loadRes(`map/config/${levelStr}`, null, (err, txtAsset) => {\r\n            if (err) {\r\n                cb(err, txtAsset);\r\n                return;\r\n            }\r\n\r\n            let content = '';\r\n            if (txtAsset._file) {\r\n                if (window['LZString']) {\r\n                    content = window['LZString'].decompressFromEncodedURIComponent(txtAsset._file);\r\n                }\r\n                var objJson = JSON.parse(content);\r\n                cb(null, objJson);\r\n            } else if (txtAsset.text) {\r\n                if (window['LZString']) {\r\n                    content = window['LZString'].decompressFromEncodedURIComponent(txtAsset.text);\r\n                }\r\n                var objJson = JSON.parse(content);\r\n                cb(null, objJson);\r\n            } else if (txtAsset.json) {\r\n                cb(null, txtAsset.json);\r\n            } else {\r\n                cb('failed');\r\n            }\r\n        });\r\n    }\r\n\r\n    public static getUIPrefabRes(prefabPath: string, cb?: Function) {\r\n        this.loadRes(\"prefab/ui/\" + prefabPath, Prefab, cb);\r\n    }\r\n\r\n    public static createUI(path: string, cb?: Function, parent?: Node) {\r\n        this.getUIPrefabRes(path, function (err, prefab) {\r\n            if (err) return;\r\n            var node = instantiate(prefab);\r\n            node.setPosition(0, 0, 0);\r\n            if (!parent) {\r\n                parent = find(\"Canvas\") as Node;\r\n            }\r\n\r\n            parent.addChild(node);\r\n            cb && cb(null, node);\r\n        });\r\n    }\r\n\r\n    public static getUICar(name: string, cb: Function) {\r\n        this.loadRes(`prefab/ui/car/uiCar${name}`, Prefab, cb);\r\n    }\r\n\r\n    public static getCar(name: string, cb: Function) {\r\n        this.loadRes(`prefab/car/car${name}`, Prefab, cb);\r\n    }\r\n\r\n    public static setCarIcon(name: string, sprite: SpriteComponent, isBlack: boolean, cb: Function) {\r\n        let path = `gamePackage/texture/car/car${name}`;\r\n        if (isBlack) {\r\n            path += 'Black';\r\n        }\r\n\r\n        this.setSpriteFrame(path, sprite, cb);\r\n    }\r\n\r\n    public static getJsonData(fileName: string, cb: Function) {\r\n        resources.load(\"datas/\" + fileName, function (err, content: any) {\r\n            if (err) {\r\n                error(err.message || err);\r\n                return;\r\n            }\r\n\r\n            if (content.json) {\r\n                cb(err, content.json);\r\n            } else {\r\n                cb('failed!!!');\r\n            }\r\n        });\r\n    }\r\n\r\n    public static getData(fileName: string, cb: Function) {\r\n        resources.load(\"datas/\" + fileName, function (err, content: any) {\r\n            if (err) {\r\n                error(err.message || err);\r\n                return;\r\n            }\r\n\r\n            var text = content.text;\r\n\r\n            if (!text) {\r\n                resources.load(content.nativeUrl, function (err, content) {\r\n                    text = content;\r\n                    cb(err, text);\r\n                });\r\n                return;\r\n            }\r\n            cb(err, text);\r\n        });\r\n    }\r\n\r\n    public static setSpriteFrame(path: string, sprite: SpriteComponent, cb: Function) {\r\n        // sprite.node.active = false;\r\n\r\n        this.loadRes(path + '/spriteFrame', SpriteFrame, (err: any, spriteFrame: SpriteFrame) => {\r\n            if (err) {\r\n                console.error('set sprite frame failed! err:', path, err);\r\n                cb(err);\r\n                return;\r\n            }\r\n\r\n            if (sprite && isValid(sprite)) {\r\n                sprite.spriteFrame = spriteFrame;\r\n                // sprite.node.active = true;\r\n                cb(null);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 获取顾客预制体\r\n     *\r\n     * @static\r\n     * @param {string} name\r\n     * @param {Function} cb\r\n     * @memberof resourceUtil\r\n     */\r\n    public static getCustomer(name: string, cb: Function) {\r\n        this.loadRes(`gamePackage/map/customer/customer${name}`, Prefab, cb);\r\n    }\r\n\r\n    public static setCustomerIcon(name: string, sprite: SpriteComponent, cb: Function) {\r\n        let path = `gamePackage/texture/head/head${name}`;\r\n\r\n        this.setSpriteFrame(path, sprite, cb);\r\n    }\r\n\r\n    public static getEffect(name: string, cb: Function) {\r\n        this.loadRes(`prefab/effect/${name}`, Prefab, cb);\r\n    }\r\n\r\n    /**\r\n * sprite置灰或者复原\r\n *\r\n * @param {object} node\r\n * @param {boolean} flag\r\n */\r\n    public static setGray(node: Node, flag: boolean) {\r\n        var sprites = node.getComponentsInChildren(SpriteComponent);\r\n        for (var i = 0; i < sprites.length; ++i) {\r\n            var sprite = sprites[i];\r\n            if (flag) {\r\n                sprite.color = new Color(255, 255, 255, 255);\r\n            } else {\r\n                sprite.color = new Color(124, 124, 124, 255);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 获取帽子prefab\r\n     * @param name 帽子名称\r\n     * @param cb \r\n     * @returns \r\n     */\r\n    public static getHat(name: string) {\r\n        return new Promise((resolve, reject) => {\r\n            this.loadRes(`prefab/model/hat/${name}`, Prefab, (err: any, prefab: Prefab) => {\r\n                if (err) {\r\n                    console.error('model load failed', name);\r\n                    reject && reject();\r\n                    return;\r\n                }\r\n\r\n                resolve && resolve(prefab);\r\n            })\r\n        })\r\n    }\r\n\r\n    /**\r\n    * 获取鞋子prefab\r\n    * @param name 鞋子名称\r\n    * @param cb \r\n    * @returns \r\n    */\r\n    public static getShoes(name: string) {\r\n        return new Promise((resolve, reject) => {\r\n            this.loadRes(`prefab/model/shoes/${name}`, Prefab, (err: any, prefab: Prefab) => {\r\n                if (err) {\r\n                    console.error('model load failed', name);\r\n                    reject && reject();\r\n                    return;\r\n                }\r\n\r\n                resolve && resolve(prefab);\r\n            })\r\n        })\r\n    }\r\n}\r\n"]}