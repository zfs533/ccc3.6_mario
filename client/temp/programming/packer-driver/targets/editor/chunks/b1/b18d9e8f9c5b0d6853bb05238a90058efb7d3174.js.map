{"version":3,"sources":["file:///E:/CocosCreator/git/mario/client/assets/script/game/pieces/hole.ts"],"names":["_decorator","Enum","RigidBody2D","BoxCollider2D","Vec3","EnumHole","EnumPhysicsGroup","baseCollider","roleManager","ccclass","property","hole","type","_rb2d","_b2d","_pos1","_pos2","start","rb2d","node","getComponent","enabledContactListener","console","log","group","b2d","onBeginContact","selfCollider","otherCollider","contact","name1","name","name2","Inst","convertToNodeSpace","canDown","enabled","normal"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAA6BC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,W,OAAAA,W;AAA4CC,MAAAA,a,OAAAA,a;AAAeC,MAAAA,I,OAAAA,I;;AAC9FC,MAAAA,Q,iBAAAA,Q;AAAUC,MAAAA,gB,iBAAAA,gB;;AACVC,MAAAA,Y,iBAAAA,Y;;AACAC,MAAAA,W,iBAAAA,W;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBV,U;;sBAGjBW,I,WADZF,OAAO,CAAC,MAAD,C,UAGHC,QAAQ,CAAC;AAAEE,QAAAA,IAAI,EAAEX,IAAI;AAAA;AAAA;AAAZ,OAAD,C,2BAHb,MACaU,IADb;AAAA;AAAA,wCACuC;AAAA;AAAA;;AAAA;;AAAA,eAK3BE,KAL2B;AAAA,eAM3BC,IAN2B;AAAA,eAO3BC,KAP2B,GAOd,IAAIX,IAAJ,EAPc;AAAA,eAQ3BY,KAR2B,GAQd,IAAIZ,IAAJ,EARc;AAAA;;AAUnCa,QAAAA,KAAK,GAAG;AACJ,gBAAMA,KAAN;AACA,cAAIC,IAAkB,GAAG,KAAKC,IAAL,CAAUC,YAAV,CAAuBlB,WAAvB,CAAzB;AACAgB,UAAAA,IAAI,CAACG,sBAAL,GAA8B,IAA9B;AACAC,UAAAA,OAAO,CAACC,GAAR,CAAYL,IAAI,CAACM,KAAjB;AACAN,UAAAA,IAAI,CAACM,KAAL,GAAa;AAAA;AAAA,oDAAiBb,IAA9B;AAEA,cAAIc,GAAiB,GAAG,KAAKN,IAAL,CAAUC,YAAV,CAAuBjB,aAAvB,CAAxB;AACAsB,UAAAA,GAAG,CAACD,KAAJ,GAAY;AAAA;AAAA,oDAAiBb,IAA7B;AAEA,eAAKE,KAAL,GAAaK,IAAb;AACA,eAAKJ,IAAL,GAAaW,GAAb;AACH;AAED;AACJ;AACA;AACA;AACA;AACA;;;AACWC,QAAAA,cAAc,CAACC,YAAD,EAA2BC,aAA3B,EAAsDC,OAAtD,EAAyF;AAC1G;AACA,cAAIC,KAAK,GAAGH,YAAY,CAACR,IAAb,CAAkBY,IAA9B;AACA,cAAIC,KAAK,GAAGJ,aAAa,CAACT,IAAd,CAAmBY,IAA/B;AACA,eAAKhB,KAAL,GAAa;AAAA;AAAA,0CAAYkB,IAAZ,CAAiBC,kBAAjB,CAAoCP,YAAY,CAACR,IAAjD,CAAb;AACA,eAAKH,KAAL,GAAa;AAAA;AAAA,0CAAYiB,IAAZ,CAAiBC,kBAAjB,CAAoCN,aAAa,CAACT,IAAlD,CAAb;AACAG,UAAAA,OAAO,CAACC,GAAR,CAAYO,KAAZ,EAAkBE,KAAlB;AACAV,UAAAA,OAAO,CAACC,GAAR,CAAY,KAAKR,KAAjB,EAAuB,KAAKC,KAA5B;;AACA,cAAG,KAAKJ,IAAL,IAAa;AAAA;AAAA,oCAASuB,OAAzB,EAAiC;AAC7B,iBAAKrB,IAAL,CAAUsB,OAAV,GAAoB,KAApB;AACH;AACJ;;AAzCkC,O;;;;;iBAGlB;AAAA;AAAA,oCAASC,M","sourcesContent":["import { _decorator, Component, Node, Enum, RigidBody2D, Collider2D, IPhysics2DContact, BoxCollider2D, Vec3 } from 'cc';\r\nimport { EnumHole, EnumPhysicsGroup } from '../../framework/enum';\r\nimport { baseCollider } from '../collider/baseCollider';\r\nimport { roleManager } from '../roles/roleManager';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('hole')\r\nexport class hole extends baseCollider {\r\n\r\n    @property({ type: Enum(EnumHole) })\r\n    type: EnumHole = EnumHole.normal;\r\n\r\n    private _rb2d:RigidBody2D;\r\n    private _b2d:BoxCollider2D;\r\n    private _pos1:Vec3 = new Vec3();\r\n    private _pos2:Vec3 = new Vec3();\r\n\r\n    start() {\r\n        super.start();\r\n        let rb2d : RigidBody2D = this.node.getComponent(RigidBody2D)\r\n        rb2d.enabledContactListener = true;\r\n        console.log(rb2d.group);\r\n        rb2d.group = EnumPhysicsGroup.hole;\r\n        \r\n        let b2d:BoxCollider2D = this.node.getComponent(BoxCollider2D);\r\n        b2d.group = EnumPhysicsGroup.hole;\r\n\r\n        this._rb2d = rb2d;\r\n        this._b2d  = b2d;\r\n    }\r\n\r\n    /**\r\n     * 子类重写\r\n     * @param selfCollider \r\n     * @param otherCollider \r\n     * @param contact \r\n     */\r\n    public onBeginContact(selfCollider: Collider2D, otherCollider: Collider2D, contact: IPhysics2DContact | null) {\r\n        // 只在两个碰撞体开始接触时被调用一次\r\n        let name1 = selfCollider.node.name;\r\n        let name2 = otherCollider.node.name;\r\n        this._pos1 = roleManager.Inst.convertToNodeSpace(selfCollider.node);\r\n        this._pos2 = roleManager.Inst.convertToNodeSpace(otherCollider.node); \r\n        console.log(name1,name2);\r\n        console.log(this._pos1,this._pos2);\r\n        if(this.type == EnumHole.canDown){\r\n            this._b2d.enabled = false;\r\n        }\r\n    }\r\n}\r\n\r\n"]}