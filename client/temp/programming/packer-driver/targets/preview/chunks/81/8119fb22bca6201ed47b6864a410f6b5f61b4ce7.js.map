{"version":3,"sources":["file:///E:/CocosCreator/git/mario/client/assets/script/game/roles/enemy/enemyTortoise.ts"],"names":["_decorator","UITransform","clientEvent","Constant","EnumEnemyStatus","enemy","ccclass","property","enemyTortoise","start","status","walk","refreshSpeedByStatus","onBeginContact","selfCollider","otherCollider","contact","isDeath","name1","node","name","name2","includes","y1","position","y","h2","getComponent","height","y2","stand","run","dispatchEvent","EVENT_TYPE","MarioDeath"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAyCC,MAAAA,W,OAAAA,W;;AACzCC,MAAAA,W,iBAAAA,W;;AACAC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,e,iBAAAA,e;;AACAC,MAAAA,K,iBAAAA,K;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBP,U;;+BAGjBQ,a,WADZF,OAAO,CAAC,eAAD,C,gBAAR,MACaE,aADb;AAAA;AAAA,0BACyC;AACrCC,QAAAA,KAAK,GAAE;AACH,gBAAMA,KAAN;AACA,eAAKC,MAAL,GAAc;AAAA;AAAA,kDAAgBC,IAA9B;AACA,eAAKC,oBAAL;AACH;;AAEMC,QAAAA,cAAc,CAACC,YAAD,EAA2BC,aAA3B,EAAsDC,OAAtD,EAAyF;AAC1G,gBAAMH,cAAN,CAAqBC,YAArB,EAAmCC,aAAnC,EAAkDC,OAAlD;AACA,cAAI,KAAKC,OAAT,EAAkB,OAFwF,CAG1G;;AACA,cAAIC,KAAK,GAAGJ,YAAY,CAACK,IAAb,CAAkBC,IAA9B;AACA,cAAIC,KAAK,GAAGN,aAAa,CAACI,IAAd,CAAmBC,IAA/B;;AACA,cAAIC,KAAK,CAACC,QAAN,CAAe,OAAf,CAAJ,EAA6B;AACzB,gBAAIC,EAAE,GAAGT,YAAY,CAACK,IAAb,CAAkBK,QAAlB,CAA2BC,CAApC;AACA,gBAAIC,EAAE,GAAGZ,YAAY,CAACK,IAAb,CAAkBQ,YAAlB,CAA+B1B,WAA/B,EAA4C2B,MAArD;AACAL,YAAAA,EAAE,IAAIG,EAAN;AACA,gBAAIG,EAAE,GAAGd,aAAa,CAACI,IAAd,CAAmBK,QAAnB,CAA4BC,CAArC;;AACA,gBAAII,EAAE,IAAIN,EAAV,EAAc;AACV,kBAAG,KAAKb,MAAL,IAAe;AAAA;AAAA,sDAAgBC,IAA/B,IAAuC,KAAKD,MAAL,IAAe;AAAA;AAAA,sDAAgBoB,KAAzE,EAA+E;AAC3E,qBAAKpB,MAAL,GAAc;AAAA;AAAA,wDAAgBqB,GAA9B;AACH,eAFD,MAGK,IAAG,KAAKrB,MAAL,IAAe;AAAA;AAAA,sDAAgBqB,GAAlC,EAAsC;AACvC,qBAAKrB,MAAL,GAAc;AAAA;AAAA,wDAAgBoB,KAA9B;AACH;;AACD,mBAAKlB,oBAAL;AACH,aARD,MASK;AACD;AAAA;AAAA,8CAAYoB,aAAZ,CAA0B;AAAA;AAAA,wCAASC,UAAT,CAAoBC,UAA9C;AACH;AACJ;AACJ;;AA/BoC,O","sourcesContent":["import { _decorator, Component, Node, Collider2D, UITransform, IPhysics2DContact } from 'cc';\r\nimport { clientEvent } from '../../../framework/clientEvent';\r\nimport { Constant } from '../../../framework/constant';\r\nimport { EnumEnemyStatus } from '../../../framework/enum';\r\nimport { enemy } from './enemy';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('enemyTortoise')\r\nexport class enemyTortoise extends enemy {\r\n    start(){\r\n        super.start();\r\n        this.status = EnumEnemyStatus.walk;\r\n        this.refreshSpeedByStatus();\r\n    }\r\n\r\n    public onBeginContact(selfCollider: Collider2D, otherCollider: Collider2D, contact: IPhysics2DContact | null) {\r\n        super.onBeginContact(selfCollider, otherCollider, contact);\r\n        if (this.isDeath) return;\r\n        // 只在两个碰撞体开始接触时被调用一次\r\n        let name1 = selfCollider.node.name;\r\n        let name2 = otherCollider.node.name;\r\n        if (name2.includes(\"mario\")) {\r\n            let y1 = selfCollider.node.position.y;\r\n            let h2 = selfCollider.node.getComponent(UITransform).height;\r\n            y1 += h2;\r\n            let y2 = otherCollider.node.position.y\r\n            if (y2 >= y1) {\r\n                if(this.status == EnumEnemyStatus.walk || this.status == EnumEnemyStatus.stand){\r\n                    this.status = EnumEnemyStatus.run;\r\n                }\r\n                else if(this.status == EnumEnemyStatus.run){\r\n                    this.status = EnumEnemyStatus.stand;\r\n                }\r\n                this.refreshSpeedByStatus();\r\n            }\r\n            else {\r\n                clientEvent.dispatchEvent(Constant.EVENT_TYPE.MarioDeath);\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\n"]}