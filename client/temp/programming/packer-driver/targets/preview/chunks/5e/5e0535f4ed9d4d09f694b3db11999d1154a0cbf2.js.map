{"version":3,"sources":["file:///E:/CocosCreator/git/mario/client/assets/script/framework/clientEvent.ts"],"names":["_decorator","ccclass","property","clientEvent","on","eventName","handler","target","objHandler","handlerList","_handlers","i","length","push","off","console","log","oldObj","splice","dispatchEvent","args","args1","arguments","apply"],"mappings":"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","sourcesContent":["import { _decorator } from \"cc\";\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass(\"clientEvent\")\r\nexport class clientEvent {\r\n    private static _handlers: { [key: string]: any[] } = {};\r\n\r\n    /**\r\n     * 监听事件\r\n     * @param {string} eventName 事件名称\r\n     * @param {function} handler 监听函数\r\n     * @param {object} target 监听目标\r\n     */\r\n    public static on(eventName: string, handler: Function, target: any) {\r\n        var objHandler: {} = { handler: handler, target: target };\r\n        var handlerList: Array<any> = clientEvent._handlers[eventName];\r\n        if (!handlerList) {\r\n            handlerList = [];\r\n            clientEvent._handlers[eventName] = handlerList;\r\n        }\r\n\r\n        for (var i = 0; i < handlerList.length; i++) {\r\n            if (!handlerList[i]) {\r\n                handlerList[i] = objHandler;\r\n                return i;\r\n            }\r\n        }\r\n\r\n        handlerList.push(objHandler);\r\n\r\n        return handlerList.length;\r\n    };\r\n\r\n    /**\r\n     * 取消监听\r\n     * @param {string} eventName 监听事件\r\n     * @param {function} handler 监听函数\r\n     * @param {object} target 监听目标\r\n     */\r\n    public static off(eventName: string, handler: Function, target: any) {\r\n        var handlerList = clientEvent._handlers[eventName];\r\n        console.log(\"event_off: \"+eventName);\r\n        if (!handlerList) {\r\n            return;\r\n        }\r\n\r\n        for (var i = 0; i < handlerList.length; i++) {\r\n            var oldObj = handlerList[i];\r\n            if (oldObj.handler === handler && (!target || target === oldObj.target)) {\r\n                handlerList.splice(i, 1);\r\n                break;\r\n            }\r\n        }\r\n    };\r\n\r\n    /**\r\n     * 分发事件\r\n     * @param {string} eventName 分发事件名\r\n     * @param  {...any} params 分发事件参数\r\n     */\r\n    public static dispatchEvent(eventName: string, ...args: any) {\r\n        var handlerList = clientEvent._handlers[eventName];\r\n\r\n        var args1 = [];\r\n        var i;\r\n        for (i = 1; i < arguments.length; i++) {\r\n            args1.push(arguments[i]);\r\n        }\r\n\r\n        if (!handlerList) {\r\n            return;\r\n        }\r\n\r\n        for (i = 0; i < handlerList.length; i++) {\r\n            var objHandler = handlerList[i];\r\n            if (objHandler.handler) {\r\n                objHandler.handler.apply(objHandler.target, args1);\r\n            }\r\n        }\r\n    };\r\n}\r\n"]}