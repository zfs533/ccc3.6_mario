{"version":3,"sources":["file:///E:/CocosCreator/git/mario/client/assets/script/framework/resourceUtil.ts"],"names":["_decorator","Prefab","SpriteComponent","SpriteFrame","resources","error","Texture2D","instantiate","isValid","find","Color","ccclass","resourceUtil","loadRes","url","type","cb","load","err","res","message","loadPiecesPriefabRes","modulePath","Promise","resolve","reject","prefab","console","loadEnemyPrefabRes","loadModelRes","loadMapModelRes","getMapPrefabRes","prefabPath","createMap","path","parent","node","addChild","loadSpriteFrameRes","img","texture","image","sf","setSpriteIcon","sprite","then","spriteFrame","log","getMap","level","levelStr","txtAsset","content","_file","window","decompressFromEncodedURIComponent","objJson","JSON","parse","text","json","getUIPrefabRes","createUI","getUICar","name","getCar","setCarIcon","isBlack","setSpriteFrame","getJsonData","fileName","getData","nativeUrl","getCustomer","setCustomerIcon","getEffect","setGray","flag","sprites","getComponentsInChildren","i","length","color","getHat","getShoes"],"mappings":"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","sourcesContent":["import { _decorator, Prefab, Node, SpriteComponent, SpriteFrame, Rect, ImageAsset, resources, error, Texture2D, instantiate, isValid, find, loader, Color, Primitive, Sprite } from \"cc\";\r\nconst { ccclass } = _decorator;\r\n\r\n@ccclass(\"resourceUtil\")\r\nexport class resourceUtil {\r\n    /**\r\n     * 加载资源\r\n     * @param url   资源路径\r\n     * @param type  资源类型\r\n     * @param cb    回调\r\n     * @method loadRes\r\n     */\r\n    public static loadRes(url: string, type: any, cb: Function) {\r\n        resources.load(url, (err: any, res: any) => {\r\n            if (err) {\r\n                error(err.message || err);\r\n                cb(err, res);\r\n                return;\r\n            }\r\n\r\n            cb(null, res);\r\n        })\r\n    }\r\n\r\n    public static loadPiecesPriefabRes(modulePath: string):Promise<Prefab> {\r\n        return new Promise((resolve, reject) => {\r\n            this.loadRes(`prefab/pieces/${modulePath}`, Prefab, (err: any, prefab: Prefab) => {\r\n                if (err) {\r\n                    console.error('effect load failed', modulePath);\r\n                    reject && reject();\r\n                    return;\r\n                }\r\n\r\n                resolve && resolve(prefab);\r\n            })\r\n        })\r\n    }\r\n\r\n    public static loadEnemyPrefabRes(modulePath: string):Promise<Prefab> {\r\n        return new Promise((resolve, reject) => {\r\n            this.loadRes(`prefab/enemy/${modulePath}`, Prefab, (err: any, prefab: Prefab) => {\r\n                if (err) {\r\n                    console.error('effect load failed', modulePath);\r\n                    reject && reject();\r\n                    return;\r\n                }\r\n\r\n                resolve && resolve(prefab);\r\n            })\r\n        })\r\n    }\r\n\r\n    public static loadModelRes(modulePath: string) {\r\n        return new Promise((resolve, reject) => {\r\n            this.loadRes(`prefab/model/${modulePath}`, Prefab, (err: any, prefab: Prefab) => {\r\n                if (err) {\r\n                    console.error(\"model load failed\", modulePath);\r\n                    reject && reject();\r\n                    return;\r\n                }\r\n\r\n                resolve && resolve(prefab);\r\n            })\r\n        })\r\n    }\r\n\r\n    public static loadMapModelRes(modulePath: string) {\r\n        return new Promise((resolve, reject) => {\r\n            this.loadRes(`prefab/map/${modulePath}`, Prefab, (err: any, prefab: Prefab) => {\r\n                if (err) {\r\n                    console.error(\"map model load failed\", modulePath);\r\n                    reject && reject();\r\n                    return;\r\n                }\r\n\r\n                resolve && resolve(prefab);\r\n            })\r\n        })\r\n    }\r\n\r\n    public static getMapPrefabRes(prefabPath: string, cb?: Function) {\r\n        this.loadRes(\"prefab/map/\" + prefabPath, Prefab, cb);\r\n    }\r\n\r\n    public static createMap(path: string, cb?: Function, parent?: Node) {\r\n        this.getMapPrefabRes(path, function (err, prefab) {\r\n            if (err) return;\r\n            var node = instantiate(prefab);\r\n            // node.setPosition(0, 0, 0);\r\n            if (!parent) {\r\n                parent = find(\"Canvas\") as Node;\r\n            }\r\n\r\n            parent.addChild(node);\r\n            cb && cb(null, node);\r\n        });\r\n    }\r\n\r\n    public static loadSpriteFrameRes(path: string) {\r\n        return new Promise((resolve, reject) => {\r\n            this.loadRes(path, SpriteFrame, (err: any, img: ImageAsset) => {\r\n                if (err) {\r\n                    console.error('spriteFrame load failed!', path, err);\r\n                    reject && reject();\r\n                    return;\r\n                }\r\n\r\n                let texture = new Texture2D();\r\n                texture.image = img;\r\n\r\n                let sf = new SpriteFrame();\r\n                sf.texture = texture;\r\n\r\n                resolve && resolve(sf);\r\n            })\r\n        })\r\n    }\r\n\r\n    public static setSpriteIcon(path: string, sprite: Sprite, cb?: Function) {\r\n        this.loadSpriteFrameRes(path).then((sf) => {\r\n            if (sprite && isValid(sprite)) {\r\n                sprite.spriteFrame = sf as SpriteFrame;\r\n                cb && cb();\r\n            } else {\r\n                console.log(\"sprite is null\");\r\n            }\r\n        })\r\n    }\r\n\r\n    public static getMap(level: number, cb: Function) {\r\n        let levelStr = 'map';\r\n        //前面补0\r\n        if (level >= 100) {\r\n            levelStr += level;\r\n        } else if (level >= 10) {\r\n            levelStr += '0' + level;\r\n        } else {\r\n            levelStr += '00' + level;\r\n        }\r\n\r\n        this.loadRes(`map/config/${levelStr}`, null, (err, txtAsset) => {\r\n            if (err) {\r\n                cb(err, txtAsset);\r\n                return;\r\n            }\r\n\r\n            let content = '';\r\n            if (txtAsset._file) {\r\n                if (window['LZString']) {\r\n                    content = window['LZString'].decompressFromEncodedURIComponent(txtAsset._file);\r\n                }\r\n                var objJson = JSON.parse(content);\r\n                cb(null, objJson);\r\n            } else if (txtAsset.text) {\r\n                if (window['LZString']) {\r\n                    content = window['LZString'].decompressFromEncodedURIComponent(txtAsset.text);\r\n                }\r\n                var objJson = JSON.parse(content);\r\n                cb(null, objJson);\r\n            } else if (txtAsset.json) {\r\n                cb(null, txtAsset.json);\r\n            } else {\r\n                cb('failed');\r\n            }\r\n        });\r\n    }\r\n\r\n    public static getUIPrefabRes(prefabPath: string, cb?: Function) {\r\n        this.loadRes(\"prefab/ui/\" + prefabPath, Prefab, cb);\r\n    }\r\n\r\n    public static createUI(path: string, cb?: Function, parent?: Node) {\r\n        this.getUIPrefabRes(path, function (err, prefab) {\r\n            if (err) return;\r\n            var node = instantiate(prefab);\r\n            // node.setPosition(0, 0, 0);\r\n            if (!parent) {\r\n                parent = find(\"Canvas\") as Node;\r\n            }\r\n\r\n            parent.addChild(node);\r\n            cb && cb(null, node);\r\n        });\r\n    }\r\n\r\n    public static getUICar(name: string, cb: Function) {\r\n        this.loadRes(`prefab/ui/car/uiCar${name}`, Prefab, cb);\r\n    }\r\n\r\n    public static getCar(name: string, cb: Function) {\r\n        this.loadRes(`prefab/car/car${name}`, Prefab, cb);\r\n    }\r\n\r\n    public static setCarIcon(name: string, sprite: SpriteComponent, isBlack: boolean, cb: Function) {\r\n        let path = `gamePackage/texture/car/car${name}`;\r\n        if (isBlack) {\r\n            path += 'Black';\r\n        }\r\n\r\n        this.setSpriteFrame(path, sprite, cb);\r\n    }\r\n\r\n    public static getJsonData(fileName: string, cb: Function) {\r\n        resources.load(\"datas/\" + fileName, function (err, content: any) {\r\n            if (err) {\r\n                error(err.message || err);\r\n                return;\r\n            }\r\n\r\n            if (content.json) {\r\n                cb(err, content.json);\r\n            } else {\r\n                cb('failed!!!');\r\n            }\r\n        });\r\n    }\r\n\r\n    public static getData(fileName: string, cb: Function) {\r\n        resources.load(\"datas/\" + fileName, function (err, content: any) {\r\n            if (err) {\r\n                error(err.message || err);\r\n                return;\r\n            }\r\n\r\n            var text = content.text;\r\n\r\n            if (!text) {\r\n                resources.load(content.nativeUrl, function (err, content) {\r\n                    text = content;\r\n                    cb(err, text);\r\n                });\r\n                return;\r\n            }\r\n            cb(err, text);\r\n        });\r\n    }\r\n\r\n    public static setSpriteFrame(path: string, sprite: SpriteComponent, cb: Function) {\r\n        // sprite.node.active = false;\r\n\r\n        this.loadRes(path + '/spriteFrame', SpriteFrame, (err: any, spriteFrame: SpriteFrame) => {\r\n            if (err) {\r\n                console.error('set sprite frame failed! err:', path, err);\r\n                cb(err);\r\n                return;\r\n            }\r\n\r\n            if (sprite && isValid(sprite)) {\r\n                sprite.spriteFrame = spriteFrame;\r\n                // sprite.node.active = true;\r\n                cb(null);\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 获取顾客预制体\r\n     *\r\n     * @static\r\n     * @param {string} name\r\n     * @param {Function} cb\r\n     * @memberof resourceUtil\r\n     */\r\n    public static getCustomer(name: string, cb: Function) {\r\n        this.loadRes(`gamePackage/map/customer/customer${name}`, Prefab, cb);\r\n    }\r\n\r\n    public static setCustomerIcon(name: string, sprite: SpriteComponent, cb: Function) {\r\n        let path = `gamePackage/texture/head/head${name}`;\r\n\r\n        this.setSpriteFrame(path, sprite, cb);\r\n    }\r\n\r\n    public static getEffect(name: string, cb: Function) {\r\n        this.loadRes(`prefab/effect/${name}`, Prefab, cb);\r\n    }\r\n\r\n    /**\r\n * sprite置灰或者复原\r\n *\r\n * @param {object} node\r\n * @param {boolean} flag\r\n */\r\n    public static setGray(node: Node, flag: boolean) {\r\n        var sprites = node.getComponentsInChildren(SpriteComponent);\r\n        for (var i = 0; i < sprites.length; ++i) {\r\n            var sprite = sprites[i];\r\n            if (flag) {\r\n                sprite.color = new Color(255, 255, 255, 255);\r\n            } else {\r\n                sprite.color = new Color(124, 124, 124, 255);\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 获取帽子prefab\r\n     * @param name 帽子名称\r\n     * @param cb \r\n     * @returns \r\n     */\r\n    public static getHat(name: string) {\r\n        return new Promise((resolve, reject) => {\r\n            this.loadRes(`prefab/model/hat/${name}`, Prefab, (err: any, prefab: Prefab) => {\r\n                if (err) {\r\n                    console.error('model load failed', name);\r\n                    reject && reject();\r\n                    return;\r\n                }\r\n\r\n                resolve && resolve(prefab);\r\n            })\r\n        })\r\n    }\r\n\r\n    /**\r\n    * 获取鞋子prefab\r\n    * @param name 鞋子名称\r\n    * @param cb \r\n    * @returns \r\n    */\r\n    public static getShoes(name: string) {\r\n        return new Promise((resolve, reject) => {\r\n            this.loadRes(`prefab/model/shoes/${name}`, Prefab, (err: any, prefab: Prefab) => {\r\n                if (err) {\r\n                    console.error('model load failed', name);\r\n                    reject && reject();\r\n                    return;\r\n                }\r\n\r\n                resolve && resolve(prefab);\r\n            })\r\n        })\r\n    }\r\n}\r\n"]}